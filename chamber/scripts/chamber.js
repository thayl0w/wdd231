document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("timestamp");e&&(e.value=(new Date).toISOString());const t=document.querySelector(".menu-icon"),n=document.querySelector(".nav-menu");t.addEventListener("click",function(){n.classList.toggle("active")}),document.getElementById("year").textContent=(new Date).getFullYear(),document.getElementById("lastModified").textContent=document.lastModified;const o=document.getElementById("directory-container");o&&fetch("data/members.json").then(e=>e.json()).then(e=>{a(e.members)}).catch(e=>{console.error("Error loading members:",e),o.innerHTML="<p>Directory data unavailable.</p>"});const c=document.getElementById("spotlight-container");c&&fetch("data/members.json").then(e=>e.json()).then(e=>{i(e.members)}).catch(e=>{console.error("Error loading members for spotlight:",e),c.innerHTML="<p>Spotlight data unavailable.</p>"});const d=document.getElementById("places-container");d&&fetch("data/places.json").then(e=>e.json()).then(e=>{console.log("Places data:",e),s(e.places)}).catch(e=>{console.error("Error loading places:",e),d.innerHTML="<p>Places data unavailable.</p>"});const l=document.getElementById("toggleView");l&&l.addEventListener("click",function(){o.classList.toggle("list-view")});const r=document.querySelectorAll(".animated-element"),m=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target.classList.add("scroll-triggered"),m.unobserve(e.target))})});r.forEach(e=>{m.observe(e)}),window.showModal=function(e){const t=document.getElementById(e);t&&(t.style.display="flex")},window.closeModal=function(e){const t=document.getElementById(e);t&&(t.style.display="none")},window.addEventListener("click",function(e){document.querySelectorAll(".modal").forEach(t=>{e.target===t&&(t.style.display="none")})});const u=document.getElementById("visitMessage"),p=localStorage.getItem("lastVisit"),y=new Date;if(p){const e=new Date(p),t=Math.floor((y-e)/864e5);u.textContent=t<1?"Welcome back! You last visited today.":`Welcome back! You last visited ${t} day(s) ago.`}else u.textContent="Welcome! This is your first time visiting this page.";localStorage.setItem("lastVisit",y);function a(e){const t=document.getElementById("directory-container");t&&(t.innerHTML="",e.forEach(e=>{const n=document.createElement("div");n.classList.add("directory-item","animated-element"),n.innerHTML=`<img src="${e.imageUrl}" alt="${e.name} Logo" class="business-logo"><h3>${e.name}</h3><p><strong>Industry:</strong> ${e.industry}</p><p><strong>Address:</strong> ${e.address}</p><p><strong>Phone:</strong> ${e.phone}</p><p><strong>Membership Level:</strong> ${b(e.membershipLevel)}</p><a href="${e.website}" target="_blank">Visit Website</a>`,t.appendChild(n)}))}function b(e){return{1:"Basic",2:"Silver",3:"Gold"}[e]||"Unknown"}function i(e){const t=e.filter(e=>2===e.membershipLevel||3===e.membershipLevel),n=[];for(;n.length<2;){const e=Math.floor(Math.random()*t.length);n.push(t.splice(e,1)[0])}const o=document.getElementById("spotlight-container");o.innerHTML="",n.forEach(e=>{const t=document.createElement("div");t.classList.add("member","animated-element"),t.innerHTML=`<img src="${e.imageUrl}" alt="${e.name}" class="business-logo"><h2>${e.name}</h2><p>${e.address}</p><p><strong>Phone:</strong> ${e.phone}</p><p><strong>Website:</strong> <a href="${e.website}" target="_blank">${e.website}</a></p><p><strong>Industry:</strong> ${e.industry}</p>`,o.appendChild(t)})}function s(e){const t=document.getElementById("places-container");t&&(t.innerHTML="",e.forEach((e,n)=>{const o=document.createElement("div");o.classList.add("place-card"),o.innerHTML=`<figure><img src="${e.image}" alt="${e.name}" class="place-image" loading="lazy"><figcaption>${e.name}</figcaption></figure><div class="card-info"><address>${e.address}</address><p>${e.description}</p><p><strong>Cost:</strong> ${e.cost}</p><p><strong>Distance:</strong> ${e.distance}</p><button class="learn-more" data-modal-id="modal-${n}" onclick="showModal('modal-${n}')">Learn More</button><div id="modal-${n}" class="modal"><div class="modal-content"><span class="close" onclick="closeModal('modal-${n}')">&times;</span><h2>${e.name}</h2><p>${e.description}</p><p><strong>Address:</strong> ${e.address}</p><p><strong>Cost:</strong> ${e.cost}</p><p><strong>Distance:</strong> ${e.distance}</p></div></div></div>`,o.style.gridArea=`card${n+1}`,t.appendChild(o),o.addEventListener("click",function(){this.classList.toggle("active")})}))}});
